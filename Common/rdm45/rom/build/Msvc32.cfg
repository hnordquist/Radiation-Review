# Microsoft make rules

# Tools -- must have path to these in your PATH
CC           = cl
LINK         = link
IMPLIB       = implib
LIBEXE       = lib
RC           = rc

!IF "$(QUICKWINAPP)" != ""
QUICKWINOPT  = -DCONSOLE 
!ENDIF

# Compile Options
# Build Large Model DLL
!IF "$(TARGET_TYPE)" == "WIN32DLL"
CCFLAGS      = -Zp1 -GX- -W3 -MD -YX"vpp.hpp" -Fp"$(OBJDIR)\$(LIBNAME).PCH" -c -DWIN32 -D_WINDOWS $(RDXOPTS)
CCFLAGS_OPT  = -O2 -DNDEBUG 
CCFLAGS_DBG  = -Zi -Od -Gf -D_DEBUG -Gm
LNKFLAGS     = /VERSION:3.0 /SUBSYSTEM:windows /DLL /INCREMENTAL:no /PDB:"$(LIBDIR)\$(LIBNAME).PDB" /MACHINE:I386 /OUT:"$(LIBNAME).dll" /IMPLIB:"$(LIBNAME).lib" 
LNKFLAGS_DBG = /DEBUG /MAP:"$(LIBNAME).MAP"
RCFLAGS      = /30
CC_LIBS      = kernel32.lib user32.lib gdi32.lib
LIBEND       = ;
LINKEND      = $(RDXLIB).lib $(CC_LIBS)
!ENDIF

# Build Large Model Windows Application
!IF "$(TARGET_TYPE)" == "WIN32APP"
CCFLAGS      = -Zp1 -GX- -W3 -MD -YX"vpp.hpp" -c -DWIN32 -D_WINDOWS $(RDXOPTS) $(QUICKWINOPT)
CCFLAGS_OPT  = -O2 -Ob2 -DNDEBUG 
CCFLAGS_DBG  = -Zi -Od -Gf -D_DEBUG 
LNKFLAGS     = /SUBSYSTEM:console /INCREMENTAL:yes /MACHINE:I386 /OUT:"$(PROG).exe" 
LNKFLAGS_DBG = /DEBUG
RCFLAGS      = /t/30
CC_LIBS      = user32.lib gdi32.lib 
LIBEND       = ;
LINKEND      = $(ROMLIB).lib $(RDXLIB).lib $(CC_LIBS)
!ENDIF


MKCMD        = $(CC) @mkopts.fil $(INCPATHS) -Fo$*.obj
RCOPTS       = $(RCFLAGS)

# Debug options
!IFDEF DEBUG
CCOPTS       = $(CCFLAGS)  $(CCFLAGS_DBG)
LNKOPTS      = $(LNKFLAGS) $(LNKFLAGS_DBG)
!ELSE
CCOPTS       = $(CCFLAGS)  $(CCFLAGS_OPT)
LNKOPTS      = $(LNKFLAGS) 
!ENDIF

